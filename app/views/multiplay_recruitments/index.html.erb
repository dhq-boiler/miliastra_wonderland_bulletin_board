<div class="max-w-4xl mx-auto p-5 bg-white min-h-screen">
  <h1 class="text-gray-800 border-b-4 border-purple-500 pb-2.5 mb-8 text-3xl font-bold">ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤å‹Ÿé›†æ²ç¤ºæ¿</h1>

  <div class="actions">
    <% if logged_in? %>
      <%= link_to "æ–°ã—ã„ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤å‹Ÿé›†ã‚’æŠ•ç¨¿", new_multiplay_recruitment_path, class: "btn btn-primary" %>
    <% else %>
      <p class="login-prompt">æŠ•ç¨¿ã™ã‚‹ã«ã¯<%= link_to "ãƒ­ã‚°ã‚¤ãƒ³", login_path %>ãŒå¿…è¦ã§ã™ã€‚</p>
    <% end %>
  </div>

  <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
  <div class="mt-8 mb-0">
    <nav class="flex justify-evenly gap-3 bg-gradient-to-b from-gray-50 to-white p-2 rounded-t-xl border-b-0">
      <button id="active-tab" class="tab-button group relative px-12 py-4 font-semibold transition-all duration-300 ease-out rounded-lg flex-1 max-w-xs" onclick="switchTab('active')">
        <span class="flex items-center justify-center gap-3">
          <svg class="w-6 h-6 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          <span class="text-base font-bold">ç¾åœ¨å‹Ÿé›†ä¸­</span>
          <span class="tab-badge inline-flex items-center justify-center min-w-[2rem] h-8 px-2.5 text-sm font-bold rounded-lg transition-all duration-300">
            <%= @active_recruitments.size %>
          </span>
        </span>
        <div class="tab-indicator absolute bottom-0 left-0 right-0 h-1 rounded-t-full transition-all duration-300"></div>
      </button>
      <button id="past-tab" class="tab-button group relative px-12 py-4 font-semibold transition-all duration-300 ease-out rounded-lg flex-1 max-w-xs" onclick="switchTab('past')">
        <span class="flex items-center justify-center gap-3">
          <svg class="w-6 h-6 transition-transform group-hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span class="text-base font-bold">éå»ã®å‹Ÿé›†</span>
          <span class="tab-badge inline-flex items-center justify-center min-w-[2rem] h-8 px-2.5 text-sm font-bold rounded-lg transition-all duration-300">
            <%= @past_recruitments.size %>
          </span>
        </span>
        <div class="tab-indicator absolute bottom-0 left-0 right-0 h-1 rounded-t-full transition-all duration-300"></div>
      </button>
    </nav>
  </div>

  <!-- ç¾åœ¨å‹Ÿé›†ä¸­ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <div id="active-content" class="stages-list tab-content">
    <% if @active_recruitments.any? %>
      <% @active_recruitments.each do |recruitment| %>
        <div class="stage-card">
          <h3><%= link_to recruitment.title, multiplay_recruitment_path(recruitment) %></h3>
          <div class="stage-info">
            <span class="<%= status_badge_class(recruitment.status) %>"><%= recruitment.status %></span>
            <% if recruitment.stage_guid.present? %>
              <span class="stage-guid">GUID: <%= clipboard_copy(recruitment.stage_guid) %></span>
            <% end %>
            <% if recruitment.difficulty.present? %>
              <span class="difficulty">é›£æ˜“åº¦: <%= recruitment.difficulty %></span>
            <% end %>
            <span class="max-players">å‹Ÿé›†äººæ•°: <%= recruitment.max_players %>äºº</span>
            <% if recruitment.start_time.present? %>
              <span class="start-time">é–‹å§‹äºˆå®š: <%= l(recruitment.start_time, format: :short) %></span>
            <% end %>
          </div>
          <p class="description"><%= truncate(recruitment.description, length: 200) %></p>
          <div class="meta">
            <span class="author">
              æŠ•ç¨¿è€…: <%= link_to recruitment.user.display_name, user_path(recruitment.user), class: "text-blue-600 hover:text-blue-800 underline" %>
              <% if recruitment.user.admin? %>
                <span class="admin-badge">ç®¡ç†è€…</span>
              <% end %>
            </span>
            <span class="date">æŠ•ç¨¿æ—¥: <%= l(recruitment.created_at, format: :short) %></span>
            <span class="comments-count">ğŸ’¬ <%= recruitment.respond_to?(:comments_count) ? recruitment.comments_count : recruitment.comments.count %>ä»¶</span>
            <%= diff_time(recruitment.created_at, "span", { class: "diff-time" }, auto_update: true) %>
          </div>
        </div>
      <% end %>
    <% else %>
      <p class="no-stages">ç¾åœ¨å‹Ÿé›†ä¸­ã®æŠ•ç¨¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    <% end %>
  </div>

  <!-- éå»ã®å‹Ÿé›†ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <div id="past-content" class="stages-list tab-content hidden">
    <% if @past_recruitments.any? %>
      <% @past_recruitments.each do |recruitment| %>
        <div class="stage-card">
          <h3><%= link_to recruitment.title, multiplay_recruitment_path(recruitment) %></h3>
          <div class="stage-info">
            <span class="<%= status_badge_class(recruitment.status) %>"><%= recruitment.status %></span>
            <% if recruitment.stage_guid.present? %>
              <span class="stage-guid">GUID: <%= clipboard_copy(recruitment.stage_guid) %></span>
            <% end %>
            <% if recruitment.difficulty.present? %>
              <span class="difficulty">é›£æ˜“åº¦: <%= recruitment.difficulty %></span>
            <% end %>
            <span class="max-players">å‹Ÿé›†äººæ•°: <%= recruitment.max_players %>äºº</span>
            <% if recruitment.start_time.present? %>
              <span class="start-time">é–‹å§‹äºˆå®š: <%= l(recruitment.start_time, format: :short) %></span>
            <% end %>
          </div>
          <p class="description"><%= truncate(recruitment.description, length: 200) %></p>
          <div class="meta">
            <span class="author">
              æŠ•ç¨¿è€…: <%= link_to recruitment.user.display_name, user_path(recruitment.user), class: "text-blue-600 hover:text-blue-800 underline" %>
              <% if recruitment.user.admin? %>
                <span class="admin-badge">ç®¡ç†è€…</span>
              <% end %>
            </span>
            <span class="date">æŠ•ç¨¿æ—¥: <%= l(recruitment.created_at, format: :short) %></span>
            <span class="comments-count">ğŸ’¬ <%= recruitment.respond_to?(:comments_count) ? recruitment.comments_count : recruitment.comments.count %>ä»¶</span>
            <%= diff_time(recruitment.created_at, "span", { class: "diff-time" }, auto_update: true) %>
          </div>
        </div>
      <% end %>
    <% else %>
      <p class="no-stages">éå»ã®å‹Ÿé›†ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    <% end %>
  </div>
</div>

<style>
/* ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
.tab-content {
  display: block;
  animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.tab-content.hidden {
  display: none !important;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¹ã‚¿ã‚¤ãƒ« */
.tab-button {
  position: relative;
  background: transparent;
  color: #6b7280;
  backdrop-filter: blur(8px);
}

.tab-button:hover {
  background: rgba(255, 255, 255, 0.5);
  color: #374151;
}

/* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ãƒ– */
.tab-button.active {
  background: white;
  color: #047857;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
              0 2px 4px -1px rgba(0, 0, 0, 0.06),
              inset 0 -2px 0 0 #10b981;
}

.tab-button.active.past-active {
  color: #1f2937;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
              0 2px 4px -1px rgba(0, 0, 0, 0.06),
              inset 0 -2px 0 0 #6b7280;
}

/* ãƒãƒƒã‚¸ã®ã‚¹ã‚¿ã‚¤ãƒ« */
.tab-button .tab-badge {
  background: #e5e7eb;
  color: #6b7280;
}

.tab-button.active .tab-badge {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  color: white;
  box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
}

.tab-button.active.past-active .tab-badge {
  background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
  color: white;
  box-shadow: 0 2px 4px rgba(107, 114, 128, 0.3);
}

/* ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãƒ©ã‚¤ãƒ³ */
.tab-indicator {
  background: transparent;
}

.tab-button.active .tab-indicator {
  background: linear-gradient(90deg, transparent, #10b981, transparent);
  box-shadow: 0 0 8px rgba(16, 185, 129, 0.5);
}

.tab-button.active.past-active .tab-indicator {
  background: linear-gradient(90deg, transparent, #6b7280, transparent);
  box-shadow: 0 0 8px rgba(107, 114, 128, 0.5);
}

/* SVGã‚¢ã‚¤ã‚³ãƒ³ã®ã‚«ãƒ©ãƒ¼ */
.tab-button svg {
  color: inherit;
  opacity: 0.7;
}

.tab-button.active svg {
  opacity: 1;
}
</style>

<script>
function switchTab(tabName) {
  // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
  const allContents = document.querySelectorAll('.tab-content');
  allContents.forEach(content => {
    content.classList.add('hidden');
    content.style.display = 'none';
  });

  // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
  const allButtons = document.querySelectorAll('.tab-button');
  allButtons.forEach(button => {
    button.classList.remove('active', 'past-active');
  });

  // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–
  if (tabName === 'active') {
    const activeContent = document.getElementById('active-content');
    const activeTab = document.getElementById('active-tab');

    activeContent.classList.remove('hidden');
    activeContent.style.display = 'block';
    activeTab.classList.add('active');
  } else if (tabName === 'past') {
    const pastContent = document.getElementById('past-content');
    const pastTab = document.getElementById('past-tab');

    pastContent.classList.remove('hidden');
    pastContent.style.display = 'block';
    pastTab.classList.add('active', 'past-active');
  }
}

// åˆæœŸåŒ–ï¼šãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–ã‚’è¨­å®š
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('active-tab').classList.add('active');
});
</script>

