<div class="max-w-4xl mx-auto p-5 bg-white min-h-screen">
  <div class="stage-detail">
    <h1 class="text-gray-800 border-b-4 border-purple-500 pb-2.5 mb-8 text-3xl font-bold"><%= @multiplay_recruitment.title %></h1>

    <div class="stage-info">
      <span class="<%= status_badge_class(@multiplay_recruitment.status) %>"><%= @multiplay_recruitment.status %></span>
      <% if @multiplay_recruitment.stage_guid.present? %>
        <span class="stage-guid"><%= t('app.common.guid') %>: <%= clipboard_copy(@multiplay_recruitment.stage_guid) %></span>
      <% end %>
      <% if @multiplay_recruitment.difficulty.present? %>
        <span class="difficulty"><%= t('app.common.difficulty_label') %>: <%= @multiplay_recruitment.difficulty %></span>
      <% end %>
      <span class="max-players"><%= t('app.common.max_players') %>: <%= @multiplay_recruitment.max_players %><%= t('app.common.people') %></span>
      <% if @multiplay_recruitment.start_time.present? %>
        <span class="start-time"><%= t('app.common.start_time') %>: <%= l(@multiplay_recruitment.start_time, format: :long) %></span>
      <% end %>
      <% if @multiplay_recruitment.end_time.present? %>
        <span class="end-time"><%= t('app.common.end_time') %>: <%= l(@multiplay_recruitment.end_time, format: :long) %></span>
      <% end %>
    </div>

    <div class="stage-content">
      <h3><%= t('app.multiplay.show.details_title') %></h3>
      <p class="description"><%= simple_format(@multiplay_recruitment.description) %></p>
    </div>

    <div class="meta">
      <p>
        <%= t('app.common.posted_by') %>: <%= link_to @multiplay_recruitment.user.display_name, user_path(@multiplay_recruitment.user), class: "text-blue-600 hover:text-blue-800 underline" %>
        <% if @multiplay_recruitment.user.admin? %>
          <span class="admin-badge"><%= t('app.common.admin_badge') %></span>
        <% end %>
      </p>
      <p><%= t('app.common.posted_at') %>: <%= l(@multiplay_recruitment.created_at, format: :long) %></p>
      <% if @multiplay_recruitment.updated_at != @multiplay_recruitment.created_at %>
        <p><%= t('app.multiplay.show.updated_at') %>: <%= l(@multiplay_recruitment.updated_at, format: :long) %></p>
      <% end %>
    </div>

    <div class="actions">
      <% if logged_in? %>
        <% if @multiplay_recruitment.user == current_user %>
          <%= link_to t('app.common.edit'), edit_multiplay_recruitment_path(@multiplay_recruitment), class: "btn btn-secondary" %>
          <%= button_to t('app.common.delete'), multiplay_recruitment_path(@multiplay_recruitment), method: :delete, data: { turbo_confirm: t('app.multiplay.show.confirm_delete') }, class: "btn btn-danger" %>
        <% elsif current_user.admin? %>
          <%= button_to t('app.common.delete'), multiplay_recruitment_path(@multiplay_recruitment), method: :delete, data: { turbo_confirm: t('app.multiplay.show.confirm_delete_admin') }, class: "btn btn-danger" %>
        <% end %>
      <% end %>
      <%= link_to t('app.common.back'), multiplay_recruitments_path, class: "btn btn-default" %>
    </div>

    <!-- コメントセクション -->
    <div class="comments-section">
      <h2 class="comments-title"><%= t('app.multiplay.show.comments_title', count: @comments.count) %></h2>

      <% if logged_in? %>
        <%= render "multiplay_recruitment_comments/form", multiplay_recruitment: @multiplay_recruitment, comment: @comment %>
      <% else %>
        <p class="login-prompt"><%= t('app.multiplay.show.login_required_html', login_link: link_to(t('app.menu.login'), login_path)).html_safe %></p>
      <% end %>

      <div class="comments-list">
        <% if @comments.any? %>
          <% @comments.each do |comment| %>
            <%= render "multiplay_recruitment_comments/comment", comment: comment, multiplay_recruitment: @multiplay_recruitment %>
          <% end %>
        <% else %>
          <p class="no-comments"><%= t('app.multiplay.show.no_comments') %></p>
        <% end %>
      </div>
    </div>
  </div>
</div>

