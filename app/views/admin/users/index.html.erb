<div class="admin-container">
  <h1 class="admin-header">ユーザー管理</h1>

  <!-- 統計情報 -->
  <div class="admin-stats">
    <div class="stat-card">
      <div class="stat-label">全ユーザー</div>
      <div class="stat-value"><%= @stats[:total] %></div>
    </div>
    <div class="stat-card active">
      <div class="stat-label">アクティブ</div>
      <div class="stat-value"><%= @stats[:active] %></div>
    </div>
    <div class="stat-card suspended">
      <div class="stat-label">停止中</div>
      <div class="stat-value"><%= @stats[:suspended] %></div>
    </div>
    <div class="stat-card banned">
      <div class="stat-label">BAN済み</div>
      <div class="stat-value"><%= @stats[:banned] %></div>
    </div>
    <div class="stat-card admin">
      <div class="stat-label">管理者</div>
      <div class="stat-value"><%= @stats[:admin] %></div>
    </div>
  </div>

  <!-- フィルター -->
  <div class="admin-filters">
    <%= link_to "すべて", admin_users_path, class: "filter-btn #{'active' if @status_filter == 'all'}" %>
    <%= link_to "アクティブ", admin_users_path(status: 'active'), class: "filter-btn #{'active' if @status_filter == 'active'}" %>
    <%= link_to "停止中", admin_users_path(status: 'suspended'), class: "filter-btn #{'active' if @status_filter == 'suspended'}" %>
    <%= link_to "BAN済み", admin_users_path(status: 'banned'), class: "filter-btn #{'active' if @status_filter == 'banned'}" %>
    <%= link_to "管理者", admin_users_path(status: 'admin'), class: "filter-btn #{'active' if @status_filter == 'admin'}" %>
  </div>

  <!-- ユーザー一覧 -->
  <div class="admin-users-list">
    <% if @users.any? %>
      <table class="admin-table">
        <thead>
          <tr>
            <th>ユーザー名</th>
            <th>メール</th>
            <th>ステータス</th>
            <th>役割</th>
            <th>登録日</th>
            <th>投稿数</th>
            <th>アクション</th>
          </tr>
        </thead>
        <tbody>
          <% @users.each do |user| %>
            <tr class="user-row">
              <td><%= link_to user.display_name, user_path(user), class: "user-link" %></td>
              <td><%= user.email.present? ? user.email : "-" %></td>
              <td>
                <% if user.banned? %>
                  <span class="user-status-badge banned">BAN済み</span>
                <% elsif user.suspended? %>
                  <span class="user-status-badge suspended">停止中</span>
                <% else %>
                  <span class="user-status-badge active">アクティブ</span>
                <% end %>
              </td>
              <td>
                <% if user.admin? %>
                  <span class="role-badge admin">管理者</span>
                <% else %>
                  <span class="role-badge user">一般</span>
                <% end %>
              </td>
              <td><%= l(user.created_at, format: :short) %></td>
              <td><%= user.stages.count %></td>
              <td class="actions-cell">
                <%= link_to "詳細", admin_user_path(user), class: "btn-action btn-detail" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <div class="empty-state">
        <p>ユーザーがいません</p>
      </div>
    <% end %>
  </div>

  <div class="admin-actions">
    <%= link_to "通報管理", admin_image_reports_path, class: "btn btn-secondary" %>
    <%= link_to "戻る", root_path, class: "btn btn-default" %>
  </div>
</div>
