# Miliastra Wonderland 掲示板

ゲーム「Miliastra Wonderland」のための掲示板アプリケーションです。
幻境（ステージ）の攻略情報を共有したり、マルチプレイの同行者を募集できます。


## 機能

### 実装済み
- **ステージ紹介投稿機能**
  - ステージの詳細情報（タイトル、ステージ番号、GUID、難易度、説明、攻略のコツ）を投稿
  - 投稿の閲覧、編集、削除
  - 投稿者による編集・削除の権限管理

- **ユーザー認証機能**
  - ユーザー登録（メールアドレスは任意）
  - ハイブリッドログイン（ユーザー名またはメールアドレスでログイン可能）
  - ログアウト
  - セッション管理
  - パスワードリセット（メールアドレス登録済みユーザー向け）

- **管理者機能**
  - 管理者専用作成（`admin:create`タスク）
  - 全投稿の削除権限
  - 管理者バッジ表示

### 今後実装予定
- マルチプレイ同行者募集機能

## セットアップ

### 必要な環境
- Ruby 3.4.7
- Rails 8.1.1
- SQLite3

### インストール手順

1. リポジトリをクローン
```bash
git clone [repository-url]
cd miliastra_wonderland_bulletin_board
```

2. 依存パッケージをインストール
```bash
bundle install
```

3. 環境変数の設定（必要に応じて）
```bash
# .env.exampleをコピーして.envファイルを作成
cp .env.example .env

# .envファイルを編集して必要な環境変数を設定
# 開発環境では通常は編集不要です
```

4. データベースのセットアップ
```bash
bin/rails db:migrate
bin/rails db:seed  # サンプルデータを作成（任意）
```

5. サーバーを起動
```bash
bin/rails server
```

6. ブラウザで http://localhost:3000 にアクセス

## 使い方

### 新規登録
1. トップページの「新規登録」ボタンをクリック
2. ユーザー名、メールアドレス、パスワードを入力
3. 「登録」ボタンをクリック
### ログイン
1. トップページの「ログイン」ボタンをクリック
2. ユーザー名またはメールアドレスとパスワードを入力
   - ユーザー名、メールアドレスのどちらでもログイン可能です
3. 「ログイン」ボタンをクリック


### ステージ紹介の投稿
1. ログイン後、「新しいステージ紹介を投稿」ボタンをクリック
2. 以下の情報を入力：
   - タイトル：投稿のタイトル
   - ステージ番号：ステージの識別番号（例：1-1）
   - ステージGUID：ゲーム内のステージGUID（整数）
   - 難易度：簡単/普通/難しい/とても難しい（任意）
   - ステージの説明：ステージの特徴や注意点
   - 攻略のコツ：クリアのヒントやおすすめの戦略（任意）
3. 「Create Stage」ボタンをクリックして投稿

### ステージ紹介の閲覧
- トップページに投稿一覧が表示されます
- タイトルをクリックすると詳細ページが開きます
- ログインしていなくても閲覧可能です

### ステージ紹介の編集・削除
- 自分が投稿したステージ紹介の詳細ページに「編集」「削除」ボタンが表示されます
- 他のユーザーの投稿は編集・削除できません

## 管理者ツール

本番環境での管理者ユーザー作成や管理のためのRakeタスクを用意しています。

### 管理者機能について

管理者ユーザーは以下の特別な権限を持ちます：

- ✅ **全投稿の削除権限**: 他のユーザーの投稿を削除できます（編集は不可）
- 🏷️ **管理者バッジ**: ユーザー名の横に「管理者」バッジが表示されます
- 🛡️ **管理者専用作成**: `admin:create` タスクでのみ作成できます（通常の新規登録では不可）

### 管理者ユーザーの作成

本番環境で管理者ユーザーを作成する場合：

```bash
# 開発環境
bin/rails admin:create

# 本番環境（Heroku等）
heroku run rails admin:create

# 本番環境（SSH接続後）
RAILS_ENV=production bundle exec rails admin:create
```

対話式でメールアドレス（任意）、ユーザー名、パスワードを入力します。
入力した情報はログに記録されません。

### ユーザー一覧の表示

```bash
bin/rails admin:list
```

登録されている全ユーザーの情報を表示します。

### パスワード変更

```bash
bin/rails admin:change_password
```

指定したユーザーのパスワードを変更します。

### ユーザー削除

```bash
bin/rails admin:delete
```

⚠️ 注意: ユーザーとその投稿が完全に削除されます。この操作は取り消せません。

## サンプルアカウント

`bin/rails db:seed` を実行すると、開発環境用のサンプルアカウントが作成されます。
詳細は `db/seeds.rb` を参照してください。

## 技術スタック

- **フレームワーク**: Ruby on Rails 8.1.1
- **データベース**: SQLite3
- **認証**: bcrypt (has_secure_password)
- **フロントエンド**: Turbo, Stimulus
- **スタイル**: カスタムCSS

## ライセンス

...
